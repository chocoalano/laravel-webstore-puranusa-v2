import{u as Q}from"./useDashboard-P1BsVIhj.js";import{w as z,r as $,I as x,c as p,d as U,k as R,F as j,l as K,b as S,e as h,f as s,g as d,t as w,i as C,u}from"./app-Ct9AQz3a.js";import{_ as N}from"./Card-Bg0Kv25I.js";import{_ as B}from"./Icon-DLkENiec.js";import{_ as L}from"./Pagination-DVApUaVH.js";import{_ as F}from"./Button-DlP5TfEn.js";import{_ as M}from"./Table-CtuFXPy6.js";import{_ as V}from"./Tabs-DedxrtHO.js";import{_ as q}from"./Input-DKYkVkaK.js";import"./Presence-CTfVoSjs.js";import"./useLocale-QzNUJIp8.js";import"./index-CygXWxiy.js";import"./utils-BSTWYaBh.js";import"./RovingFocusItem-8kWj2Je9.js";import"./Badge-BrOriF3i.js";function A(t){if(!t)return"-";const o=new Date(t);return Number.isNaN(o.getTime())?t:new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(o)}function H(t){const o=[];return t.from_member?.name&&o.push(t.from_member.name),t.from_member?.email&&o.push(t.from_member.email),t.meta?.level!==void 0&&t.meta.level!==null&&o.push(`Level ${t.meta.level}`),t.meta?.pairing_count!==void 0&&t.meta.pairing_count!==null&&o.push(`Pair ${t.meta.pairing_count}`),t.meta?.order_id!==void 0&&t.meta.order_id!==null&&o.push(`Order #${t.meta.order_id}`),t.meta?.reward_name&&o.push(`Reward ${t.meta.reward_name}`),t.meta?.reward_type&&o.push(`Type ${t.meta.reward_type}`),o.join(" â€¢ ")}function E(t){const{formatIDR:o}=Q(),a=[{key:"referral_incentive",label:"Referral Incentive",icon:"i-lucide-users"},{key:"team_affiliate_commission",label:"Team Affiliate Commission",icon:"i-lucide-handshake"},{key:"partner_team_commission",label:"Partner Team Commission",icon:"i-lucide-network"},{key:"cashback_commission",label:"Cashback Commission",icon:"i-lucide-percent"},{key:"promotions_rewards",label:"Promotions Rewards",icon:"i-lucide-gift"},{key:"retail_commission",label:"Retail Commission",icon:"i-lucide-store"},{key:"lifetime_cash_rewards",label:"Lifetime Cash Rewards",icon:"i-lucide-trophy"}],m=[...a.map(e=>({key:e.key,title:e.label,icon:e.icon})),{key:"total_bonus",title:"Total Bonus",icon:"i-lucide-wallet-cards"}],_=[{label:"Semua",value:"all",icon:"i-lucide-layout-grid"},...a.map(e=>({label:e.label,value:e.key,icon:e.icon}))],l=$("all"),g=$(""),f=$(1),b=10,y=p(()=>m.map(e=>{const n=t.bonusStats.value.find(r=>r.key===e.key);return{key:e.key,title:e.title,icon:e.icon,amount:Number(n?.amount??0),count:Number(n?.count??0)}})),v=p(()=>({referral_incentive:[...t.bonusTables.value.referral_incentive],team_affiliate_commission:[...t.bonusTables.value.team_affiliate_commission],partner_team_commission:[...t.bonusTables.value.partner_team_commission],cashback_commission:[...t.bonusTables.value.cashback_commission],promotions_rewards:[...t.bonusTables.value.promotions_rewards],retail_commission:[...t.bonusTables.value.retail_commission],lifetime_cash_rewards:[...t.bonusTables.value.lifetime_cash_rewards]})),T=p(()=>a.flatMap(e=>v.value[e.key]).sort((e,n)=>{const r=e.created_at?new Date(e.created_at).getTime():0,k=n.created_at?new Date(n.created_at).getTime():0;return r===k?Number(n.id)-Number(e.id):k-r})),c=p(()=>{const e=g.value.trim().toLowerCase(),n=l.value==="all"?T.value:v.value[l.value]??[];return e===""?n:n.filter(r=>[r.type_label,r.description??"",r.from_member?.name??"",r.from_member?.email??"",r.meta?.reward_name??"",r.meta?.reward_type??""].join(" ").toLowerCase().includes(e))});z([l,g],()=>{f.value=1});const i=p(()=>{const e=(f.value-1)*b;return c.value.slice(e,e+b)});return{activeTab:l,searchQuery:g,page:f,itemsPerPage:b,tabs:_,displayedStats:y,filteredRows:c,paginatedRows:i,columns:[{id:"created_at",accessorKey:"created_at",header:"Tanggal",cell:({row:e})=>x("span",{class:"text-sm text-muted"},A(e.original.created_at))},{id:"description",accessorKey:"description",header:"Keterangan",cell:({row:e})=>{const n=e.original,r=H(n);return x("div",{class:"min-w-0 flex flex-col"},[x("span",{class:"truncate text-sm font-semibold text-highlighted"},n.type_label),x("span",{class:"truncate text-xs text-muted"},n.description&&n.description.trim()!==""?n.description:"-"),x("span",{class:"truncate text-[11px] text-muted"},r!==""?r:"-")])}},{id:"amount",accessorKey:"amount",header:"Nominal",meta:{class:{th:"text-right",td:"text-right"}},cell:({row:e})=>x("span",{class:"font-bold text-primary tabular-nums"},o(Number(e.original.amount??0)))},{id:"status",accessorKey:"status",header:"Status",cell:({row:e})=>{const n=e.original.status==="released";return x("span",{class:["inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium capitalize",n?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300"]},e.original.status_label)}}],formatIDR:o}}const G={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4"},O={class:"mb-2 flex items-center gap-2"},J={class:"text-[10px] font-bold uppercase tracking-wider text-muted"},W={class:"flex flex-col"},X={class:"text-xl font-bold text-highlighted"},Y={class:"text-xs text-muted"},Z=U({__name:"BonusStatsGrid",props:{stats:{},formatCurrency:{type:Function}},setup(t){return(o,a)=>{const m=B,_=N;return C(),R("div",G,[(C(!0),R(j,null,K(t.stats,l=>(C(),S(_,{key:l.key,class:"rounded-2xl"},{default:h(()=>[s("div",O,[d(m,{name:l.icon,class:"size-4 text-primary"},null,8,["name"]),s("span",J,w(l.title),1)]),s("div",W,[s("span",X,w(t.formatCurrency(l.amount)),1),s("span",Y,w(l.count)+" transaksi",1)])]),_:2},1024))),128))])}}}),ee={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},te={class:"flex items-center gap-2"},ae={class:"border-b border-default"},se={class:"overflow-x-auto px-2 py-1 sm:px-0 sm:py-0"},oe={class:"overflow-x-auto"},ne={class:"flex flex-col items-center justify-center py-10"},ie={class:"flex flex-col gap-3 px-4 py-3 sm:flex-row sm:items-center sm:justify-between"},re={class:"text-xs text-muted"},le={class:"flex items-center justify-between gap-4 py-2 sm:hidden border-t border-gray-100 dark:border-gray-800"},ce={class:"flex flex-col items-center"},me={class:"flex items-baseline gap-1"},ue={class:"text-sm font-black text-primary-600 dark:text-primary-400"},de={class:"text-xs font-medium text-gray-500"},pe=U({__name:"BonusHistoryTableCard",props:{activeTab:{},searchQuery:{},page:{},itemsPerPage:{},tabs:{},rows:{},totalRows:{},columns:{}},emits:["update:activeTab","update:searchQuery","update:page"],setup(t,{emit:o}){const a=t,m=o;function _(c){m("update:searchQuery",String(c??""))}function l(c){m("update:activeTab",String(c??"all"))}function g(c){m("update:page",c)}const f=p(()=>{const c=Math.max(1,a.itemsPerPage);return Math.max(1,Math.ceil(a.totalRows/c))}),b=p(()=>a.page>1),y=p(()=>a.page<f.value);function v(){b.value&&m("update:page",a.page-1)}function T(){y.value&&m("update:page",a.page+1)}return(c,i)=>{const P=q,e=V,n=B,r=M,k=F,D=L,I=N;return C(),S(I,{class:"overflow-hidden rounded-2xl",ui:{body:"p-0 sm:p-0",header:"px-4 py-4"}},{header:h(()=>[s("div",ee,[i[0]||(i[0]=s("h3",{class:"text-base font-bold text-highlighted"},"Riwayat Bonus",-1)),s("div",te,[d(P,{"model-value":a.searchQuery,icon:"i-lucide-search",placeholder:"Cari deskripsi, member, reward...",size:"sm",class:"w-full sm:w-72","onUpdate:modelValue":_},null,8,["model-value"])])])]),footer:h(()=>[s("div",ie,[s("span",re,"Total "+w(a.totalRows)+" data",1),s("div",le,[d(k,{icon:"i-lucide-arrow-left",color:"neutral",variant:"ghost",size:"sm",disabled:!b.value,onClick:v,class:"rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900"},{default:h(()=>[...i[2]||(i[2]=[s("span",{class:"text-xs font-medium"},"Prev",-1)])]),_:1},8,["disabled"]),s("div",ce,[i[4]||(i[4]=s("span",{class:"text-[10px] uppercase tracking-widest text-gray-400 font-bold"},"Halaman",-1)),s("div",me,[s("span",ue,w(a.page),1),i[3]||(i[3]=s("span",{class:"text-xs text-gray-300 dark:text-gray-600"},"/",-1)),s("span",de,w(f.value),1)])]),d(k,{icon:"i-lucide-arrow-right",color:"neutral",variant:"ghost",size:"sm",trailing:"",disabled:!y.value,onClick:T,class:"rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900"},{default:h(()=>[...i[5]||(i[5]=[s("span",{class:"text-xs font-medium"},"Next",-1)])]),_:1},8,["disabled"])]),d(D,{class:"hidden sm:flex",page:a.page,total:a.totalRows,"items-per-page":a.itemsPerPage,size:"sm","onUpdate:page":g},null,8,["page","total","items-per-page"])])]),default:h(()=>[s("div",ae,[s("div",se,[d(e,{"model-value":a.activeTab,items:a.tabs,"value-key":"value",content:!1,class:"w-max min-w-full","onUpdate:modelValue":l},null,8,["model-value","items"])])]),s("div",oe,[d(r,{data:a.rows,columns:a.columns,class:"w-full min-w-180"},{empty:h(()=>[s("div",ne,[d(n,{name:"i-lucide-database-backup",class:"mb-2 size-8 text-muted"}),i[1]||(i[1]=s("p",{class:"text-sm text-muted"},"Belum ada data bonus untuk kategori ini.",-1))])]),_:1},8,["data","columns"])])]),_:1})}}}),_e={class:"space-y-6"},Se=U({__name:"Bonus",props:{bonusStats:{default:()=>[]},bonusTables:{default:()=>({referral_incentive:[],team_affiliate_commission:[],partner_team_commission:[],cashback_commission:[],promotions_rewards:[],retail_commission:[],lifetime_cash_rewards:[]})}},setup(t){const o=t,{activeTab:a,searchQuery:m,page:_,itemsPerPage:l,tabs:g,displayedStats:f,filteredRows:b,paginatedRows:y,columns:v,formatIDR:T}=E({bonusStats:p(()=>o.bonusStats),bonusTables:p(()=>o.bonusTables)});function c(e){a.value=e}function i(e){m.value=e}function P(e){_.value=e}return(e,n)=>(C(),R("div",_e,[d(Z,{stats:u(f),"format-currency":u(T)},null,8,["stats","format-currency"]),d(pe,{"active-tab":u(a),"search-query":u(m),page:u(_),"items-per-page":u(l),tabs:u(g),rows:u(y),"total-rows":u(b).length,columns:u(v),"onUpdate:activeTab":c,"onUpdate:searchQuery":i,"onUpdate:page":P},null,8,["active-tab","search-query","page","items-per-page","tabs","rows","total-rows","columns"])]))}});export{Se as default};
