import{_ as De}from"./Card-cS3RJCXC.js";import{_ as Q}from"./Button-D3HFYD0O.js";import{_ as se}from"./Icon-HLcQNufH.js";import{_ as Ae}from"./Badge-Dj3YBdeK.js";import{d as X,k as $,g as r,f as s,e as _,h as w,F as _e,l as be,c as P,t as h,b as E,j as T,i as y,E as ve,G as L,w as de,r as x,q as Ue,H as ce,a as M,u as b,v as ue}from"./app-Dpk2qVhs.js";import{_ as ye}from"./Modal-CeQOkZl5.js";import{_ as Ve}from"./SelectMenu-DERZyep-.js";import{_ as Ie}from"./Textarea-Cvbrqwq-.js";import{_ as Se}from"./Checkbox-BVf1N_5-.js";import{_ as je}from"./FormField-D83BjFAY.js";import{_ as Be}from"./Input-CzHuiSw4.js";import"./DialogTrigger-Br19wQdd.js";import"./Presence-Bdn01jZp.js";import"./usePortal-CLMo3DUw.js";import"./VisuallyHidden-BJmj1zui.js";import"./useLocale-CA26Ptc0.js";import"./PopperArrow-D2znCzMG.js";import"./utils-CWiJOLA-.js";import"./VisuallyHiddenInput-iJgpq9SD.js";import"./index-CZ7JqbuJ.js";import"./RovingFocusItem-3HBrCzkB.js";import"./Label-pGx1TQ6T.js";const Fe={key:0,class:"py-12 text-center text-gray-500 dark:text-gray-400"},Oe={class:"mt-4"},Pe={key:1,class:"space-y-3"},ze={class:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"},Me={class:"min-w-0"},Te={class:"flex flex-wrap items-center gap-2"},qe={class:"text-sm font-semibold text-gray-900 dark:text-white"},Ee={class:"mt-1 text-sm text-gray-600 dark:text-gray-300"},Le={class:"mt-2 text-sm text-gray-700 dark:text-gray-200"},Ne={key:0,class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},Ke={class:"flex flex-wrap items-center gap-2 sm:justify-end"},Re=X({__name:"AddressList",props:{addresses:{},settingDefault:{}},emits:["create","edit","delete","setDefault"],setup(o){const f=o,t=P(()=>f.addresses.length>0);function c(m){return m||"—"}function a(m){const p=m.address_line2?`, ${m.address_line2}`:"",k=m.postal_code?`, ${m.postal_code}`:"";return`${m.address_line1}${p}, ${m.city_label}, ${m.province_label}${k}`}return(m,p)=>{const k=se,i=Q,g=Ae;return t.value?(y(),$("div",Pe,[(y(!0),$(_e,null,be(o.addresses,u=>(y(),$("div",{key:u.id,class:"rounded-2xl border border-gray-200 bg-white/70 p-4 backdrop-blur dark:border-gray-800 dark:bg-gray-950/40"},[s("div",ze,[s("div",Me,[s("div",Te,[s("p",qe,h(u.label||"Alamat"),1),u.is_default?(y(),E(g,{key:0,label:"Default",color:"success",variant:"soft",size:"xs",class:"rounded-full"})):T("",!0)]),s("p",Ee,h(u.recipient_name)+" • "+h(c(u.recipient_phone)),1),s("p",Le,h(a(u)),1),u.description?(y(),$("p",Ne," Catatan: "+h(u.description),1)):T("",!0)]),s("div",Ke,[u.is_default?T("",!0):(y(),E(i,{key:0,color:"neutral",variant:"outline",size:"sm",class:"rounded-xl",icon:"i-lucide-check",loading:!!o.settingDefault[String(u.id)],onClick:I=>m.$emit("setDefault",u)},{default:_(()=>[...p[4]||(p[4]=[w(" Jadikan Default ",-1)])]),_:1},8,["loading","onClick"])),r(i,{color:"neutral",variant:"outline",size:"sm",class:"rounded-xl",icon:"i-lucide-pencil",onClick:I=>m.$emit("edit",u)},{default:_(()=>[...p[5]||(p[5]=[w(" Edit ",-1)])]),_:1},8,["onClick"]),r(i,{color:"error",variant:"soft",size:"sm",class:"rounded-xl",icon:"i-lucide-trash-2",onClick:I=>m.$emit("delete",u)},{default:_(()=>[...p[6]||(p[6]=[w(" Hapus ",-1)])]),_:1},8,["onClick"])])])]))),128))])):(y(),$("div",Fe,[r(k,{name:"i-lucide-map-pin",class:"mx-auto size-10 opacity-40"}),p[2]||(p[2]=s("p",{class:"mt-3 text-sm"},"Belum ada alamat tersimpan.",-1)),p[3]||(p[3]=s("p",{class:"mt-1 text-xs"},"Tambahkan alamat untuk mempercepat proses checkout.",-1)),s("div",Oe,[r(i,{color:"primary",variant:"solid",class:"rounded-xl",icon:"i-lucide-plus",onClick:p[0]||(p[0]=u=>m.$emit("create"))},{default:_(()=>[...p[1]||(p[1]=[w(" Tambah Alamat Pertama ",-1)])]),_:1})])]))}}}),He={class:"w-full max-w-2xl space-y-4"},Je={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2"},Ge={class:"w-full"},We={class:"mt-2 flex items-center gap-2"},Qe={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2"},Xe={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2"},Ye={class:"space-y-2"},Ze={key:0,class:"text-xs text-blue-600 dark:text-blue-300"},et={key:1,class:"text-xs text-amber-600 dark:text-amber-300"},tt={class:"space-y-2"},it={key:0,class:"text-xs text-blue-600 dark:text-blue-300"},lt={key:1,class:"text-xs text-amber-600 dark:text-amber-300"},st={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2"},at={class:"space-y-2"},ot={key:0,class:"text-xs text-blue-600 dark:text-blue-300"},rt={key:1,class:"text-xs text-amber-600 dark:text-amber-300"},nt={class:"grid w-full grid-cols-1 gap-3 sm:grid-cols-2"},dt={key:0,class:"rounded-2xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-700 dark:border-rose-900/50 dark:bg-rose-950/40 dark:text-rose-200"},ct={class:"mt-1 list-disc pl-5 space-y-1"},ut={class:"flex flex-col-reverse gap-2 pt-2 sm:flex-row sm:items-center sm:justify-between"},mt={class:"flex gap-2"},pt=X({__name:"AddressFormModal",props:L({mode:{},form:{},errors:{},submitting:{type:Boolean},loadingProvinces:{type:Boolean},loadingCities:{type:Boolean},loadingDistricts:{type:Boolean},provinceItems:{},cityItems:{},districtItems:{}},{open:{type:Boolean,required:!0},openModifiers:{}}),emits:L(["submit","reset"],["update:open"]),setup(o){const f=ve(o,"open"),t=o,c=P(()=>t.mode==="create"?"Tambah Alamat":"Edit Alamat"),a=P(()=>t.mode==="create"?"Isi detail alamat untuk pengiriman & checkout.":"Perbarui detail alamat yang sudah tersimpan."),m={overlay:"z-[120]",wrapper:"z-[121]",content:"z-[122]"},p={content:"z-[130]"};return(k,i)=>{const g=Be,u=je,I=Se,z=Ie,B=Ve,S=Q,F=ye;return y(),E(F,{open:f.value,"onUpdate:open":i[16]||(i[16]=n=>f.value=n),title:c.value,description:a.value,scrollable:"",ui:m},{body:_(()=>[s("div",He,[s("div",Je,[r(u,{label:"Label (opsional)",class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.label,"onUpdate:modelValue":i[0]||(i[0]=n=>t.form.label=n),placeholder:"Contoh: Rumah, Kantor",class:"w-full"},null,8,["modelValue"])]),_:1}),s("div",Ge,[i[18]||(i[18]=s("p",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Jadikan default",-1)),i[19]||(i[19]=s("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Default dipakai otomatis saat checkout. ",-1)),s("div",We,[r(I,{modelValue:t.form.is_default,"onUpdate:modelValue":i[1]||(i[1]=n=>t.form.is_default=n)},null,8,["modelValue"]),i[17]||(i[17]=s("span",{class:"text-sm text-gray-700 dark:text-gray-200"},"Set sebagai alamat utama",-1))])])]),s("div",Qe,[r(u,{label:"Nama penerima",required:"",error:t.errors.recipient_name,class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.recipient_name,"onUpdate:modelValue":i[2]||(i[2]=n=>t.form.recipient_name=n),placeholder:"Nama lengkap",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"No. HP penerima",required:"",error:t.errors.recipient_phone,class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.recipient_phone,"onUpdate:modelValue":i[3]||(i[3]=n=>t.form.recipient_phone=n),placeholder:"08xxxxxxxxxx",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"])]),r(u,{label:"Alamat utama",required:"",error:t.errors.address_line1,class:"w-full"},{default:_(()=>[r(z,{modelValue:t.form.address_line1,"onUpdate:modelValue":i[4]||(i[4]=n=>t.form.address_line1=n),placeholder:"Jalan, RT/RW, nomor, patokan...",rows:3,class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Alamat tambahan (opsional)",class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.address_line2,"onUpdate:modelValue":i[5]||(i[5]=n=>t.form.address_line2=n),placeholder:"Contoh: Blok A No. 12",class:"w-full"},null,8,["modelValue"])]),_:1}),s("div",Xe,[r(u,{label:"Provinsi",required:"",error:t.errors.province_id||t.errors.province_label,class:"w-full"},{default:_(()=>[s("div",Ye,[r(B,{modelValue:t.form.province_id,"onUpdate:modelValue":i[6]||(i[6]=n=>t.form.province_id=n),items:t.provinceItems,"value-key":"value","label-key":"label",placeholder:"Pilih provinsi",disabled:t.loadingProvinces||t.provinceItems.length===0,class:"w-full",ui:p,portal:!0},null,8,["modelValue","items","disabled"]),t.loadingProvinces?(y(),$("p",Ze," Memuat data provinsi... ")):t.provinceItems.length===0?(y(),$("p",et," Data provinsi dari RajaOngkir belum tersedia. ")):T("",!0)])]),_:1},8,["error"]),r(u,{label:"Kota/Kab",required:"",error:t.errors.city_id||t.errors.city_label,class:"w-full"},{default:_(()=>[s("div",tt,[r(B,{modelValue:t.form.city_id,"onUpdate:modelValue":i[7]||(i[7]=n=>t.form.city_id=n),items:t.cityItems,"value-key":"value","label-key":"label",placeholder:"Pilih kota/kab",disabled:!t.form.province_id||t.loadingCities||t.cityItems.length===0,class:"w-full",ui:p,portal:!0},null,8,["modelValue","items","disabled"]),t.form.province_id&&t.loadingCities?(y(),$("p",it," Memuat data kota/kabupaten... ")):t.form.province_id&&t.cityItems.length===0?(y(),$("p",lt," Data kota/kabupaten untuk provinsi ini belum tersedia. ")):T("",!0)])]),_:1},8,["error"])]),s("div",st,[r(u,{label:"Kecamatan",required:"",error:t.errors.district,class:"w-full"},{default:_(()=>[s("div",at,[r(B,{modelValue:t.form.district,"onUpdate:modelValue":i[8]||(i[8]=n=>t.form.district=n),items:t.districtItems,"value-key":"value","label-key":"label",placeholder:"Pilih kecamatan",disabled:!t.form.city_id||t.loadingDistricts||t.districtItems.length===0,class:"w-full",ui:p,portal:!0},null,8,["modelValue","items","disabled"]),t.form.city_id&&t.loadingDistricts?(y(),$("p",ot," Memuat data kecamatan... ")):t.form.city_id&&t.districtItems.length===0?(y(),$("p",rt," Data kecamatan untuk kota ini belum tersedia. ")):T("",!0)])]),_:1},8,["error"]),r(u,{label:"District Lion (auto)",error:t.errors.district_lion,class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.district_lion,"onUpdate:modelValue":i[9]||(i[9]=n=>t.form.district_lion=n),placeholder:"Terisi otomatis dari opsi kecamatan",readonly:"",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"])]),s("div",nt,[r(u,{label:"Kode pos (opsional)",error:t.errors.postal_code,class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.postal_code,"onUpdate:modelValue":i[10]||(i[10]=n=>t.form.postal_code=n),placeholder:"12345",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Negara",class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.country,"onUpdate:modelValue":i[11]||(i[11]=n=>t.form.country=n),placeholder:"Indonesia",class:"w-full"},null,8,["modelValue"])]),_:1})]),r(u,{label:"Catatan (opsional)",class:"w-full"},{default:_(()=>[r(g,{modelValue:t.form.description,"onUpdate:modelValue":i[12]||(i[12]=n=>t.form.description=n),placeholder:"Contoh: Titip satpam / rumah pagar hitam",class:"w-full"},null,8,["modelValue"])]),_:1}),Object.keys(t.errors).length?(y(),$("div",dt,[i[20]||(i[20]=s("p",{class:"font-semibold"},"Periksa kembali:",-1)),s("ul",ct,[(y(!0),$(_e,null,be(t.errors,(n,A)=>(y(),$("li",{key:A},h(n),1))),128))])])):T("",!0),s("div",ut,[r(S,{color:"neutral",variant:"outline",class:"rounded-xl",disabled:t.submitting,onClick:i[13]||(i[13]=n=>f.value=!1)},{default:_(()=>[...i[21]||(i[21]=[w(" Batal ",-1)])]),_:1},8,["disabled"]),s("div",mt,[r(S,{color:"neutral",variant:"ghost",class:"rounded-xl",disabled:t.submitting,onClick:i[14]||(i[14]=n=>k.$emit("reset"))},{default:_(()=>[...i[22]||(i[22]=[w(" Reset ",-1)])]),_:1},8,["disabled"]),r(S,{color:"primary",variant:"solid",class:"rounded-xl",loading:t.submitting,onClick:i[15]||(i[15]=n=>k.$emit("submit"))},{default:_(()=>[w(h(t.mode==="create"?"Simpan":"Update"),1)]),_:1},8,["loading"])])])])]),_:1},8,["open","title","description"])}}}),ft={class:"w-full max-w-lg space-y-3"},_t={class:"rounded-2xl border border-gray-200 bg-white/70 p-4 backdrop-blur dark:border-gray-800 dark:bg-gray-950/40"},bt={class:"text-sm font-semibold text-gray-900 dark:text-white"},vt={class:"mt-1 text-sm text-gray-600 dark:text-gray-300"},yt={class:"mt-2 text-sm text-gray-700 dark:text-gray-200"},gt={class:"rounded-2xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-800 dark:border-amber-900/50 dark:bg-amber-950/40 dark:text-amber-200"},xt={class:"flex items-start gap-2"},kt={class:"flex flex-col-reverse gap-2 pt-2 sm:flex-row sm:items-center sm:justify-between"},$t=X({__name:"AddressDeleteConfirmModal",props:L({address:{},deleting:{type:Boolean}},{open:{type:Boolean,required:!0},openModifiers:{}}),emits:L(["confirm"],["update:open"]),setup(o){const f=ve(o,"open");function t(c){const a=c.address_line2?`, ${c.address_line2}`:"",m=c.postal_code?`, ${c.postal_code}`:"";return`${c.address_line1}${a}, ${c.city_label}, ${c.province_label}${m}`}return(c,a)=>{const m=se,p=Q,k=ye;return y(),E(k,{open:f.value,"onUpdate:open":a[2]||(a[2]=i=>f.value=i),title:"Hapus alamat",description:"Aksi ini tidak bisa dibatalkan."},{body:_(()=>[s("div",ft,[s("div",_t,[s("p",bt,h(o.address?.label||"Alamat"),1),s("p",vt,h(o.address?.recipient_name)+" • "+h(o.address?.recipient_phone),1),s("p",yt,h(o.address?t(o.address):""),1)]),s("div",gt,[s("div",xt,[r(m,{name:"i-lucide-alert-triangle",class:"mt-0.5 size-4"}),a[3]||(a[3]=s("p",null,"Pastikan alamat ini tidak diperlukan untuk pengiriman berikutnya.",-1))])]),s("div",kt,[r(p,{color:"neutral",variant:"outline",class:"rounded-xl",disabled:o.deleting,onClick:a[0]||(a[0]=i=>f.value=!1)},{default:_(()=>[...a[4]||(a[4]=[w(" Batal ",-1)])]),_:1},8,["disabled"]),r(p,{color:"error",variant:"solid",class:"rounded-xl",loading:o.deleting,onClick:a[1]||(a[1]=i=>c.$emit("confirm"))},{default:_(()=>[...a[5]||(a[5]=[w(" Hapus Permanen ",-1)])]),_:1},8,["loading"])])])]),_:1},8,["open"])}}}),wt={class:"w-full max-w-2xl space-y-4"},ht={class:"rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800 dark:border-amber-900/50 dark:bg-amber-950/40 dark:text-amber-200"},Ct={class:"flex items-start gap-2"},Dt={class:"rounded-2xl border border-gray-200 bg-white/70 p-4 backdrop-blur dark:border-gray-800 dark:bg-gray-950/40"},At={class:"mt-1 text-sm text-gray-700 dark:text-gray-200"},Ut={class:"space-y-2"},Vt={key:0,class:"rounded-2xl border border-dashed border-gray-300 p-4 text-sm text-gray-600 dark:border-gray-700 dark:text-gray-300"},It={class:"mt-3"},St={key:1,class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},jt={class:"truncate text-sm font-semibold text-gray-900 dark:text-white"},Bt={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ft={class:"mt-2 line-clamp-2 text-sm text-gray-700 dark:text-gray-200"},Ot={class:"mt-3"},Pt={class:"flex justify-end pt-2"},zt=X({__name:"AddressDefaultSwitchModal",props:L({selectedAddress:{},otherAddresses:{},settingDefault:{}},{open:{type:Boolean,required:!0},openModifiers:{}}),emits:L(["createAddress","setDefaultContinue"],["update:open"]),setup(o){const f=ve(o,"open");function t(c){const a=c.address_line2?`, ${c.address_line2}`:"",m=c.postal_code?`, ${c.postal_code}`:"";return`${c.address_line1}${a}, ${c.city_label}, ${c.province_label}${m}`}return(c,a)=>{const m=se,p=Q,k=ye;return y(),E(k,{open:f.value,"onUpdate:open":a[2]||(a[2]=i=>f.value=i),title:"Tidak bisa hapus alamat default",description:"Ubah default terlebih dulu."},{body:_(()=>[s("div",wt,[s("div",ht,[s("div",Ct,[r(m,{name:"i-lucide-info",class:"mt-0.5 size-4"}),a[3]||(a[3]=s("div",{class:"min-w-0"},[s("p",{class:"font-semibold"},"Instruksi"),s("ol",{class:"mt-1 list-decimal pl-5 space-y-1"},[s("li",null,[w("Pilih alamat lain untuk dijadikan "),s("b",null,"Default"),w(".")]),s("li",null,"Setelah default berubah, lanjutkan proses hapus.")])],-1))])]),s("div",Dt,[a[4]||(a[4]=s("p",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Alamat yang ingin dihapus:",-1)),s("p",At,h(o.selectedAddress?.label||"Alamat")+" — "+h(o.selectedAddress?t(o.selectedAddress):""),1)]),s("div",Ut,[a[8]||(a[8]=s("p",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Pilih default baru:",-1)),o.otherAddresses.length===0?(y(),$("div",Vt,[a[6]||(a[6]=w(" Kamu belum punya alamat lain. Tambahkan alamat baru dulu, lalu coba hapus lagi. ",-1)),s("div",It,[r(p,{color:"primary",variant:"solid",class:"rounded-xl",icon:"i-lucide-plus",onClick:a[0]||(a[0]=i=>c.$emit("createAddress"))},{default:_(()=>[...a[5]||(a[5]=[w(" Tambah alamat ",-1)])]),_:1})])])):(y(),$("div",St,[(y(!0),$(_e,null,be(o.otherAddresses,i=>(y(),$("div",{key:i.id,class:"rounded-2xl border border-gray-200 bg-white/70 p-4 backdrop-blur dark:border-gray-800 dark:bg-gray-950/40"},[s("p",jt,h(i.label||"Alamat"),1),s("p",Bt,h(i.recipient_name)+" • "+h(i.recipient_phone),1),s("p",Ft,h(t(i)),1),s("div",Ot,[r(p,{color:"primary",variant:"soft",size:"sm",class:"rounded-xl",loading:!!o.settingDefault[String(i.id)],onClick:g=>c.$emit("setDefaultContinue",i)},{default:_(()=>[...a[7]||(a[7]=[w(" Jadikan Default & Lanjut Hapus ",-1)])]),_:1},8,["loading","onClick"])])]))),128))]))]),s("div",Pt,[r(p,{color:"neutral",variant:"outline",class:"rounded-xl",onClick:a[1]||(a[1]=i=>f.value=!1)},{default:_(()=>[...a[9]||(a[9]=[w(" Tutup ",-1)])]),_:1})])])]),_:1},8,["open"])}}});function Mt(o){return Array.isArray(o)?o.map(f=>String(f)).join(" "):o?String(o):""}function V(o){const f=Number(o);return!Number.isFinite(f)||f<=0?0:Math.trunc(f)}function me(o){return o&&typeof o=="object"&&!Array.isArray(o)?o:null}function pe(o){return typeof o=="string"?o.trim():""}function Tt(o){return o.replace(/^(kota|kabupaten)\s+/i,"").trim()}function W(o,f){const t=o.trim().toUpperCase();if(t==="")return"";const c=Tt(f).toUpperCase();return c===""?t:`${t}, ${c}`}async function fe(o){try{const f=await fetch(o,{headers:{Accept:"application/json"},credentials:"same-origin"});if(!f.ok)return[];const t=await f.json();return Array.isArray(t)?t:[]}catch{return[]}}function qt(o){const f=x(!1),t=x(!1),c=x(!1),a=x("create"),m=x(!1),p=x(!1),k=x({}),i=x(null),g=x(null),u=x({}),I=x(!1),z=x(!1),B=x(!1),S=x(!1),F=x([]),n=x([]),A=x([]),N=x(0),K=x(0),e=Ue({label:"",is_default:!1,recipient_name:"",recipient_phone:"",address_line1:"",address_line2:"",province_label:"",province_id:0,city_label:"",city_id:0,district:"",district_lion:"",postal_code:"",country:"Indonesia",description:""}),Y=P(()=>F.value.map(l=>({label:l.label,value:l.id}))),ae=P(()=>n.value.map(l=>({label:l.label,value:l.id}))),oe=P(()=>A.value.map(l=>({label:l.label,value:l.label}))),re=P(()=>{const l=g.value;return l?o.addresses.value.filter(d=>d.id!==l.id):[]});async function Z(){z.value=!0;const l=await fe("/account/addresses/options/provinces");F.value=l.map(d=>{const v=me(d);if(!v)return null;const C=V(v.id),U=pe(v.label);return!C||U===""?null:{id:C,label:U}}).filter(d=>d!==null),z.value=!1}async function ee(l){const d=V(l);N.value+=1;const v=N.value;if(n.value=[],A.value=[],!d){B.value=!1,S.value=!1;return}B.value=!0;const C=await fe(`/account/addresses/options/cities?province_id=${d}`);v===N.value&&(n.value=C.map(U=>{const j=me(U);if(!j)return null;const J=V(j.id),G=V(j.province_id),q=pe(j.label);return!J||!G||q===""?null:{id:J,province_id:G,label:q}}).filter(U=>U!==null),B.value=!1)}async function te(l){const d=V(l);K.value+=1;const v=K.value;if(A.value=[],!d){S.value=!1;return}S.value=!0;const C=await fe(`/account/addresses/options/districts?city_id=${d}`);v===K.value&&(A.value=C.map(U=>{const j=me(U);if(!j)return null;const J=V(j.id),G=V(j.city_id),q=pe(j.label);return!J||!G||q===""?null:{id:J,city_id:G,label:q,district_lion:W(q,e.city_label)}}).filter(U=>U!==null),S.value=!1)}de(()=>e.province_id,l=>{if(I.value)return;const d=V(l);if(!d){e.province_label="",e.city_id=0,e.city_label="",e.district="",e.district_lion="",n.value=[],A.value=[];return}const v=F.value.find(C=>C.id===d);v&&(e.province_label=v.label),e.city_id=0,e.city_label="",e.district="",e.district_lion="",ee(d)}),de(()=>e.city_id,l=>{if(I.value)return;const d=V(l);if(!d){e.city_label="",e.district="",e.district_lion="",A.value=[];return}const v=n.value.find(C=>C.id===d);v&&(e.city_label=v.label),e.district="",e.district_lion="",te(d)}),de(()=>e.district,l=>{if(I.value)return;const d=l.trim();if(!d||!e.city_id){e.district_lion="";return}const v=A.value.find(C=>C.label===d);e.district_lion=v?.district_lion??W(d,e.city_label)});function R(){u.value={}}function ie(){e.label="",e.is_default=!1,e.recipient_name="",e.recipient_phone="",e.address_line1="",e.address_line2="",e.province_label="",e.province_id=0,e.city_label="",e.city_id=0,e.district="",e.district_lion="",e.postal_code="",e.country="Indonesia",e.description="",n.value=[],A.value=[],R()}async function D(l){if(I.value=!0,e.label=l.label??"",e.is_default=!!l.is_default,e.recipient_name=l.recipient_name??"",e.recipient_phone=l.recipient_phone??"",e.address_line1=l.address_line1??"",e.address_line2=l.address_line2??"",e.province_label=l.province_label??"",e.province_id=V(l.province_id??0),e.city_label=l.city_label??"",e.city_id=V(l.city_id??0),e.district=l.district??"",e.district_lion=W(l.district??"",l.city_label??""),e.postal_code=l.postal_code??"",e.country=l.country??"Indonesia",e.description=l.description??"",R(),await Z(),e.province_id&&await ee(e.province_id),e.city_id&&await te(e.city_id),e.province_label.trim()===""){const d=F.value.find(v=>v.id===e.province_id);e.province_label=d?.label??""}if(e.city_label.trim()===""){const d=n.value.find(v=>v.id===e.city_id);e.city_label=d?.label??""}if(e.district.trim()!==""){const d=A.value.find(v=>v.label===e.district);e.district_lion=d?.district_lion??W(e.district,e.city_label)}await ce(),I.value=!1}function ne(){const l={};return e.recipient_name.trim()||(l.recipient_name="Nama penerima wajib diisi."),e.recipient_phone.trim()?e.recipient_phone.replace(/\D/g,"").length<8&&(l.recipient_phone="No. HP terlalu pendek."):l.recipient_phone="No. HP wajib diisi.",e.address_line1.trim()||(l.address_line1="Alamat utama wajib diisi."),e.province_id||(l.province_id="Provinsi wajib dipilih."),e.province_label.trim()||(l.province_label="Label provinsi wajib diisi dari opsi."),e.city_id||(l.city_id="Kota/Kab wajib dipilih."),e.city_label.trim()||(l.city_label="Label kota wajib diisi dari opsi."),e.district.trim()||(l.district="Kecamatan wajib dipilih."),e.postal_code&&e.postal_code.trim().length>0&&e.postal_code.trim().length<5&&(l.postal_code="Kode pos minimal 5 karakter."),u.value=l,Object.keys(l).length===0}function le(l){u.value=Object.fromEntries(Object.entries(l??{}).map(([d,v])=>[d,Mt(v)]).filter(d=>d[1].length>0))}function H(){M.reload({only:["addresses","defaultAddress"]})}function O(){a.value="create",i.value=null,ie(),f.value=!0,Z()}function ge(l){a.value="edit",i.value=l,f.value=!0,D(l)}function xe(){if(R(),!ne())return;m.value=!0;const l={label:e.label||null,is_default:!!e.is_default,recipient_name:e.recipient_name,recipient_phone:e.recipient_phone,address_line1:e.address_line1,address_line2:e.address_line2||null,province_label:e.province_label.trim(),province_id:V(e.province_id),city_label:e.city_label.trim(),city_id:V(e.city_id),district:e.district.trim(),district_lion:W(e.district,e.city_label)||null,postal_code:e.postal_code||null,country:e.country||"Indonesia",description:e.description||null},d=()=>{f.value=!1,ie(),H()},v=j=>{le(j)},C=()=>{m.value=!1};if(a.value==="create"){M.post("/account/addresses",l,{preserveScroll:!0,onSuccess:d,onError:v,onFinish:C});return}const U=i.value?.id;if(!U){m.value=!1;return}M.put(`/account/addresses/${U}`,l,{preserveScroll:!0,onSuccess:d,onError:v,onFinish:C})}function ke(l){const d=String(l.id);k.value[d]=!0,M.post(`/account/addresses/${l.id}/default`,{},{preserveScroll:!0,onSuccess:()=>{H()},onFinish:()=>{k.value[d]=!1}})}function $e(l){if(g.value=l,l.is_default){c.value=!0;return}t.value=!0}function we(){const l=g.value;l&&(p.value=!0,M.delete(`/account/addresses/${l.id}`,{preserveScroll:!0,onSuccess:()=>{t.value=!1,g.value=null,H()},onFinish:()=>{p.value=!1}}))}function he(l){if(!g.value)return;const d=String(l.id);k.value[d]=!0,M.post(`/account/addresses/${l.id}/default`,{},{preserveScroll:!0,onSuccess:()=>{c.value=!1,M.reload({only:["addresses","defaultAddress"],onSuccess:()=>{ce(()=>{t.value=!0})}})},onFinish:()=>{k.value[d]=!1}})}function Ce(){c.value=!1,ce(()=>{O()})}return{formOpen:f,deleteOpen:t,blockedOpen:c,formMode:a,submitting:m,deleting:p,settingDefault:k,selectedForDelete:g,otherAddressesForDefault:re,form:e,errors:u,loadingProvinces:z,loadingCities:B,loadingDistricts:S,provinceItems:Y,cityItems:ae,districtItems:oe,resetForm:ie,openCreate:O,openEdit:ge,submitForm:xe,setAsDefault:ke,requestDelete:$e,confirmDelete:we,setDefaultThenContinueDelete:he,closeBlockedAndOpenCreate:Ce}}const Et={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Lt={class:"flex items-center gap-3"},Nt={class:"flex items-center gap-2"},mi=X({__name:"Addresses",props:{addresses:{}},setup(o){const f=o,t=P(()=>f.addresses??[]),{formOpen:c,deleteOpen:a,blockedOpen:m,formMode:p,submitting:k,deleting:i,settingDefault:g,selectedForDelete:u,otherAddressesForDefault:I,form:z,errors:B,loadingProvinces:S,loadingCities:F,loadingDistricts:n,provinceItems:A,cityItems:N,districtItems:K,resetForm:e,openCreate:Y,openEdit:ae,submitForm:oe,setAsDefault:re,requestDelete:Z,confirmDelete:ee,setDefaultThenContinueDelete:te,closeBlockedAndOpenCreate:R}=qt({addresses:t});return(ie,D)=>{const ne=se,le=Q,H=De;return y(),E(H,{class:"rounded-2xl"},{header:_(()=>[s("div",Et,[s("div",Lt,[r(ne,{name:"i-lucide-map-pin",class:"size-5 text-gray-500 dark:text-gray-300"}),D[3]||(D[3]=s("div",null,[s("p",{class:"text-base font-semibold text-gray-900 dark:text-white"},"Alamat"),s("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Kelola alamat pengiriman untuk checkout lebih cepat. ")],-1))]),s("div",Nt,[r(le,{color:"primary",variant:"soft",size:"sm",class:"rounded-xl",icon:"i-lucide-plus",onClick:b(Y)},{default:_(()=>[...D[4]||(D[4]=[w(" Tambah Alamat ",-1)])]),_:1},8,["onClick"]),r(le,{to:"/account/addresses",color:"neutral",variant:"outline",size:"sm",class:"rounded-xl"},{default:_(()=>[...D[5]||(D[5]=[w(" Lihat Semua ",-1)])]),_:1})])])]),default:_(()=>[r(Re,{addresses:t.value,"setting-default":b(g),onCreate:b(Y),onEdit:b(ae),onDelete:b(Z),onSetDefault:b(re)},null,8,["addresses","setting-default","onCreate","onEdit","onDelete","onSetDefault"]),r(pt,{open:b(c),"onUpdate:open":D[0]||(D[0]=O=>ue(c)?c.value=O:null),mode:b(p),form:b(z),errors:b(B),submitting:b(k),"loading-provinces":b(S),"loading-cities":b(F),"loading-districts":b(n),"province-items":b(A),"city-items":b(N),"district-items":b(K),onSubmit:b(oe),onReset:b(e)},null,8,["open","mode","form","errors","submitting","loading-provinces","loading-cities","loading-districts","province-items","city-items","district-items","onSubmit","onReset"]),r($t,{open:b(a),"onUpdate:open":D[1]||(D[1]=O=>ue(a)?a.value=O:null),address:b(u),deleting:b(i),onConfirm:b(ee)},null,8,["open","address","deleting","onConfirm"]),r(zt,{open:b(m),"onUpdate:open":D[2]||(D[2]=O=>ue(m)?m.value=O:null),"selected-address":b(u),"other-addresses":b(I),"setting-default":b(g),onCreateAddress:b(R),onSetDefaultContinue:b(te)},null,8,["open","selected-address","other-addresses","setting-default","onCreateAddress","onSetDefaultContinue"])]),_:1})}}});export{mi as default};
