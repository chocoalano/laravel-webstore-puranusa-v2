import{_ as J}from"./Card-Bg0Kv25I.js";import{_ as O}from"./Button-DlP5TfEn.js";import{_ as R}from"./Textarea-DUxTFtHE.js";import{_ as Y}from"./Separator-DbQt-yTr.js";import{_ as H}from"./SelectMenu-36JS-GAY.js";import{_ as Z}from"./FormField-DR3qO_4n.js";import{_ as Q}from"./Input-DKYkVkaK.js";import{_ as X}from"./Alert-DqUIHgZi.js";import{_ as ee}from"./Badge-BrOriF3i.js";import{w as ae,q as ne,a as le,c as g,r as F,p as re,d as q,b as L,e as m,f,i as b,j as T,g as r,u as n,k as W,F as te,l as ie,t as oe,h as pe}from"./app-Ct9AQz3a.js";import{u as se}from"./useToast-DVWuh0M_.js";import"./Icon-DLkENiec.js";import"./usePortal-BjiTY23K.js";import"./Presence-CTfVoSjs.js";import"./VisuallyHidden-BSn5Ae5a.js";import"./PopperArrow-q2Y0TQCy.js";import"./utils-BSTWYaBh.js";import"./VisuallyHiddenInput-DDhaMnhq.js";import"./index-CygXWxiy.js";import"./useLocale-QzNUJIp8.js";import"./Label-CSxIoeop.js";function K(p){const o=(p??"").trim().toUpperCase();return["L","LAKI-LAKI","MALE","M"].includes(o)?"L":["P","PEREMPUAN","FEMALE","F"].includes(o)?"P":"L"}function M(p){const o=typeof p=="number"?String(p):(p??"").trim();return o==="1"||o.toUpperCase()==="L"?"1":o==="2"||o.toUpperCase()==="P"?"2":""}function y(p){const o=(p??"").trim().toUpperCase();return o==="Y"||o==="N"?o:""}function me(p){return Array.isArray(p)?p.map(o=>String(o)).join(" "):p?String(p):""}function ue(p){const o=Object.values(p).find(_=>_!==void 0);return Array.isArray(o)?o[0]??"Gagal memperbarui profil akun.":o??"Gagal memperbarui profil akun."}function de(p){const o=se(),_=re(),h=F(!1),t=F({}),s=g(()=>[{label:"Laki-laki",value:"L"},{label:"Perempuan",value:"P"}]),V=g(()=>[{label:"Laki-laki",value:"1"},{label:"Perempuan",value:"2"}]),j=g(()=>[{label:"Ya",value:"Y"},{label:"Tidak",value:"N"}]),e=ne({username:"",name:"",nik:"",gender:"L",email:"",phone:"",bank_name:"",bank_account:"",npwp_nama:"",npwp_number:"",npwp_jk:"",npwp_date:"",npwp_alamat:"",npwp_menikah:"",npwp_anak:"",npwp_kerja:"",npwp_office:""});ae(p.customer,a=>{e.username=a?.username??"",e.name=a?.name??"",e.nik=a?.nik??"",e.gender=K(a?.gender),e.email=a?.email??"",e.phone=a?.phone??"",e.bank_name=a?.bank_name??"",e.bank_account=a?.bank_account??"",e.npwp_nama=a?.npwp?.nama??"",e.npwp_number=a?.npwp?.npwp??"",e.npwp_jk=M(a?.npwp?.jk),e.npwp_date=a?.npwp?.npwp_date??"",e.npwp_alamat=a?.npwp?.alamat??"",e.npwp_menikah=y(a?.npwp?.menikah),e.npwp_anak=a?.npwp?.anak??"",e.npwp_kerja=y(a?.npwp?.kerja),e.npwp_office=a?.npwp?.office??""},{immediate:!0});function N(){t.value={}}function U(){const a=p.customer.value;e.username=a?.username??"",e.name=a?.name??"",e.nik=a?.nik??"",e.gender=K(a?.gender),e.email=a?.email??"",e.phone=a?.phone??"",e.bank_name=a?.bank_name??"",e.bank_account=a?.bank_account??"",e.npwp_nama=a?.npwp?.nama??"",e.npwp_number=a?.npwp?.npwp??"",e.npwp_jk=M(a?.npwp?.jk),e.npwp_date=a?.npwp?.npwp_date??"",e.npwp_alamat=a?.npwp?.alamat??"",e.npwp_menikah=y(a?.npwp?.menikah),e.npwp_anak=a?.npwp?.anak??"",e.npwp_kerja=y(a?.npwp?.kerja),e.npwp_office=a?.npwp?.office??"",N()}function A(){const a={},c=e.username.trim(),d=e.name.trim(),u=e.nik.replace(/\D/g,""),w=e.gender.trim().toUpperCase(),P=e.email.trim(),C=e.phone.replace(/\s+/g,""),x=e.bank_name.trim(),$=e.bank_account.replace(/\D/g,""),i=e.npwp_nama.trim(),v=e.npwp_number.trim(),I=e.npwp_jk.trim(),B=e.npwp_date.trim(),G=e.npwp_alamat.trim(),D=e.npwp_menikah.trim().toUpperCase(),S=e.npwp_anak.trim(),E=e.npwp_kerja.trim().toUpperCase(),z=e.npwp_office.trim();return/^[a-zA-Z0-9_.]{3,30}$/.test(c)||(a.username="Username 3-30 karakter dan hanya huruf/angka/underscore/titik."),d.length===0&&(a.name="Nama lengkap wajib diisi."),/^\d{16}$/.test(u)||(a.nik="NIK harus 16 digit angka."),["L","P"].includes(w)||(a.gender="Jenis kelamin wajib dipilih."),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P)||(a.email="Format email tidak valid."),/^[0-9+]{8,20}$/.test(C)||(a.phone="Nomor telepon/WhatsApp harus 8-20 karakter (angka atau +)."),x.length===0&&(a.bank_name="Nama bank wajib diisi."),/^\d{5,50}$/.test($)||(a.bank_account="Nomor rekening harus 5-50 digit angka."),v.length>0&&!/^[0-9.\-]{10,30}$/.test(v)&&(a.npwp_number="Nomor NPWP tidak valid."),I.length>0&&!["1","2"].includes(I)&&(a.npwp_jk="Jenis kelamin NPWP tidak valid."),B.length>0&&Number.isNaN(Date.parse(B))&&(a.npwp_date="Tanggal NPWP tidak valid."),D.length>0&&!["Y","N"].includes(D)&&(a.npwp_menikah="Status pernikahan NPWP tidak valid."),E.length>0&&!["Y","N"].includes(E)&&(a.npwp_kerja="Status kerja NPWP tidak valid."),S.length>0&&!/^\d{1,2}$/.test(S)&&(a.npwp_anak="Jumlah anak NPWP harus berupa angka."),i.length>255&&(a.npwp_nama="Nama NPWP maksimal 255 karakter."),G.length>1e3&&(a.npwp_alamat="Alamat NPWP maksimal 1000 karakter."),z.length>255&&(a.npwp_office="Nama kantor maksimal 255 karakter."),t.value=a,Object.keys(a).length===0}function k(a){t.value=Object.fromEntries(Object.entries(a??{}).map(([c,d])=>[c,me(d)]).filter(c=>c[1].length>0))}function l(){N(),A()&&(h.value=!0,le.post("/dashboard/account/profile",{_token:_.props.csrf_token,username:e.username.trim().toLowerCase(),name:e.name.trim(),nik:e.nik.replace(/\D/g,""),gender:e.gender.trim().toUpperCase(),email:e.email.trim().toLowerCase(),phone:e.phone.replace(/\s+/g,""),bank_name:e.bank_name.trim(),bank_account:e.bank_account.replace(/\D/g,""),npwp_nama:e.npwp_nama.trim(),npwp_number:e.npwp_number.trim(),npwp_jk:e.npwp_jk?Number(e.npwp_jk):null,npwp_date:e.npwp_date.trim(),npwp_alamat:e.npwp_alamat.trim(),npwp_menikah:e.npwp_menikah.trim().toUpperCase(),npwp_anak:e.npwp_anak.trim(),npwp_kerja:e.npwp_kerja.trim().toUpperCase(),npwp_office:e.npwp_office.trim()},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{const a=_.props.flash?.account?.message,c=typeof a=="string"&&a.length>0?a:"Profil akun berhasil diperbarui.";o.add({title:"Berhasil",description:c,color:"success"})},onError:a=>{k(a),o.add({title:"Gagal",description:ue(a),color:"error"})},onFinish:()=>{h.value=!1}}))}return{form:e,errors:t,submitting:h,genderItems:s,npwpGenderItems:V,yesNoItems:j,submit:l,resetToCurrentCustomerData:U}}const ce={class:"flex items-center justify-between"},ke={class:"space-y-6"},fe={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},_e={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},we={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},be={class:"list-disc pl-4 mt-2 space-y-1"},ge={class:"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end pt-4 border-t border-gray-100 dark:border-gray-800"},he=q({__name:"DashboardAccountFormCard",props:{customer:{default:null},defaultAddress:{default:null}},setup(p){const o=p,_=g(()=>o.customer?.name?.trim()||"—"),h=g(()=>{const k=o.defaultAddress;return k?[k.recipient_name,k.phone,k.address_line,k.city,k.province,k.postal_code].every(a=>{const c=a.trim();return c.length>0&&!["-","—"].includes(c)}):!1}),{form:t,errors:s,submitting:V,genderItems:j,npwpGenderItems:e,yesNoItems:N,submit:U,resetToCurrentCustomerData:A}=de({customer:g(()=>o.customer)});return(k,l)=>{const a=ee,c=X,d=Q,u=Z,w=H,P=Y,C=R,x=O,$=J;return b(),L($,{class:"rounded-2xl shadow-sm ring-1 ring-gray-200 dark:ring-gray-800"},{header:m(()=>[f("div",ce,[l[18]||(l[18]=f("div",null,[f("h3",{class:"text-base font-bold text-gray-900 dark:text-white"},"Pengaturan Akun"),f("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Pastikan data profil dan rekening sudah benar untuk kelancaran penarikan dana. ")],-1)),r(a,{color:"primary",variant:"subtle",class:"rounded-full px-3"},{default:m(()=>[...l[17]||(l[17]=[pe(" Profil Publik ",-1)])]),_:1})])]),default:m(()=>[f("div",ke,[h.value?T("",!0):(b(),L(c,{key:0,color:"warning",variant:"subtle",icon:"i-lucide-map-pin-off",title:"Default Alamat Lengkap Belum Tersedia",description:"Silakan atur alamat utama Anda di menu Alamat agar data pengiriman dan dokumen akun bisa tervalidasi.",ui:{title:"font-bold"}})),r(c,{color:"warning",variant:"subtle",icon:"i-lucide-shield-check",title:"Verifikasi Rekening",description:`Nama pemilik rekening harus sesuai dengan nama terdaftar: ${_.value}. Ketidaksesuaian dapat menyebabkan pembatalan otomatis pada proses withdrawal.`,ui:{title:"font-bold"}},null,8,["description"]),f("div",fe,[r(u,{label:"Username",required:"",error:n(s).username,help:"Gunakan huruf kecil, angka, atau titik. Minimal 5 karakter."},{default:m(()=>[r(d,{modelValue:n(t).username,"onUpdate:modelValue":l[0]||(l[0]=i=>n(t).username=i),placeholder:"contoh: tumbur.siahaan",icon:"i-lucide-at-sign",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Nama Lengkap",required:"",error:n(s).name,help:"Harus sesuai dengan nama yang tertera di KTP/Buku Tabungan."},{default:m(()=>[r(d,{modelValue:n(t).name,"onUpdate:modelValue":l[1]||(l[1]=i=>n(t).name=i),placeholder:"Input nama lengkap Anda",icon:"i-lucide-user",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"NIK",required:"",error:n(s).nik,help:"16 digit Nomor Induk Kependudukan sesuai KTP."},{default:m(()=>[r(d,{modelValue:n(t).nik,"onUpdate:modelValue":l[2]||(l[2]=i=>n(t).nik=i),placeholder:"32xxxxxxxxxxxxxx",inputmode:"numeric",icon:"i-lucide-id-card",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Jenis Kelamin",required:"",error:n(s).gender},{default:m(()=>[r(w,{modelValue:n(t).gender,"onUpdate:modelValue":l[3]||(l[3]=i=>n(t).gender=i),items:n(j),"value-key":"value","label-key":"label",placeholder:"Pilih jenis kelamin",icon:"i-lucide-venus-and-mars",class:"w-full"},null,8,["modelValue","items"])]),_:1},8,["error"]),r(u,{label:"Email",required:"",error:n(s).email,help:"Email aktif untuk notifikasi keamanan dan transaksi."},{default:m(()=>[r(d,{modelValue:n(t).email,"onUpdate:modelValue":l[4]||(l[4]=i=>n(t).email=i),type:"email",placeholder:"nama@email.com",icon:"i-lucide-mail",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"WhatsApp / No. Telepon",required:"",error:n(s).phone,help:"Gunakan format 08 (contoh: 08123456789)."},{default:m(()=>[r(d,{modelValue:n(t).phone,"onUpdate:modelValue":l[5]||(l[5]=i=>n(t).phone=i),placeholder:"08xxxxxxxxxx",inputmode:"tel",icon:"i-lucide-phone",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"])]),r(P,{label:"Informasi Rekening Bank",ui:{label:"text-xs font-bold uppercase tracking-widest text-gray-400"}}),f("div",_e,[r(u,{label:"Bank Utama",required:"",error:n(s).bank_name,help:"Pilih atau tuliskan nama bank Anda."},{default:m(()=>[r(d,{modelValue:n(t).bank_name,"onUpdate:modelValue":l[6]||(l[6]=i=>n(t).bank_name=i),placeholder:"BCA / Mandiri / BRI",icon:"i-lucide-landmark",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Nomor Rekening",required:"",error:n(s).bank_account,help:"Pastikan digit nomor rekening sudah tepat tanpa tanda baca."},{default:m(()=>[r(d,{modelValue:n(t).bank_account,"onUpdate:modelValue":l[7]||(l[7]=i=>n(t).bank_account=i),inputmode:"numeric",placeholder:"Contoh: 712345678",icon:"i-lucide-credit-card",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"])]),r(P,{label:"Data NPWP (Opsional)",ui:{label:"text-xs font-bold uppercase tracking-widest text-gray-400"}}),f("div",we,[r(u,{label:"Nama pada NPWP",error:n(s).npwp_nama},{default:m(()=>[r(d,{modelValue:n(t).npwp_nama,"onUpdate:modelValue":l[8]||(l[8]=i=>n(t).npwp_nama=i),placeholder:"Nama sesuai NPWP",icon:"i-lucide-user-round-search",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Nomor NPWP",error:n(s).npwp_number},{default:m(()=>[r(d,{modelValue:n(t).npwp_number,"onUpdate:modelValue":l[9]||(l[9]=i=>n(t).npwp_number=i),placeholder:"00.000.000.0-000.000",icon:"i-lucide-file-badge",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Jenis Kelamin NPWP",error:n(s).npwp_jk},{default:m(()=>[r(w,{modelValue:n(t).npwp_jk,"onUpdate:modelValue":l[10]||(l[10]=i=>n(t).npwp_jk=i),items:n(e),"value-key":"value","label-key":"label",placeholder:"Pilih jenis kelamin",icon:"i-lucide-venus-and-mars",class:"w-full"},null,8,["modelValue","items"])]),_:1},8,["error"]),r(u,{label:"Tanggal NPWP",error:n(s).npwp_date},{default:m(()=>[r(d,{modelValue:n(t).npwp_date,"onUpdate:modelValue":l[11]||(l[11]=i=>n(t).npwp_date=i),type:"date",icon:"i-lucide-calendar-days",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Status Menikah",error:n(s).npwp_menikah},{default:m(()=>[r(w,{modelValue:n(t).npwp_menikah,"onUpdate:modelValue":l[12]||(l[12]=i=>n(t).npwp_menikah=i),items:n(N),"value-key":"value","label-key":"label",placeholder:"Pilih status",icon:"i-lucide-heart",class:"w-full"},null,8,["modelValue","items"])]),_:1},8,["error"]),r(u,{label:"Status Bekerja",error:n(s).npwp_kerja},{default:m(()=>[r(w,{modelValue:n(t).npwp_kerja,"onUpdate:modelValue":l[13]||(l[13]=i=>n(t).npwp_kerja=i),items:n(N),"value-key":"value","label-key":"label",placeholder:"Pilih status",icon:"i-lucide-briefcase-business",class:"w-full"},null,8,["modelValue","items"])]),_:1},8,["error"]),r(u,{label:"Jumlah Anak",error:n(s).npwp_anak},{default:m(()=>[r(d,{modelValue:n(t).npwp_anak,"onUpdate:modelValue":l[14]||(l[14]=i=>n(t).npwp_anak=i),inputmode:"numeric",placeholder:"Contoh: 0",icon:"i-lucide-baby",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),r(u,{label:"Nama Kantor",error:n(s).npwp_office},{default:m(()=>[r(d,{modelValue:n(t).npwp_office,"onUpdate:modelValue":l[15]||(l[15]=i=>n(t).npwp_office=i),placeholder:"Nama tempat kerja",icon:"i-lucide-building-2",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"])]),r(u,{label:"Alamat NPWP",error:n(s).npwp_alamat},{default:m(()=>[r(C,{modelValue:n(t).npwp_alamat,"onUpdate:modelValue":l[16]||(l[16]=i=>n(t).npwp_alamat=i),rows:3,placeholder:"Alamat sesuai dokumen NPWP",class:"w-full"},null,8,["modelValue"])]),_:1},8,["error"]),Object.keys(n(s)).length?(b(),L(c,{key:1,color:"error",variant:"subtle",icon:"i-lucide-alert-circle",title:"Terdapat Kesalahan Input"},{description:m(()=>[f("ul",be,[(b(!0),W(te,null,ie(n(s),(i,v)=>(b(),W("li",{key:v},oe(i),1))),128))])]),_:1})):T("",!0),f("div",ge,[r(x,{color:"neutral",variant:"ghost",class:"rounded-xl px-6",disabled:n(V),onClick:n(A),label:"Batalkan"},null,8,["disabled","onClick"]),r(x,{color:"primary",variant:"solid",class:"rounded-xl px-8 shadow-lg shadow-primary-500/20",loading:n(V),onClick:n(U),label:"Simpan Data Akun"},null,8,["loading","onClick"])])])]),_:1})}}}),Ne={class:"space-y-6"},qe=q({__name:"FormAccount",props:{customer:{},defaultAddress:{}},setup(p){return(o,_)=>(b(),W("div",Ne,[r(he,{customer:p.customer,"default-address":p.defaultAddress},null,8,["customer","default-address"])]))}});export{qe as default};
