import{_ as de}from"./Card-Bg0Kv25I.js";import{w as oe,r as U,H as ye,a as H,c as T,p as he,d as Q,k as v,f as e,g as o,t as u,b as C,e as p,h as y,j as $,i as d,s as xe,o as ve,F as N,l as J,u as r,v as be}from"./app-Ct9AQz3a.js";import{u as ke}from"./useToast-DVWuh0M_.js";import{_ as ce}from"./Button-DlP5TfEn.js";import{_ as we}from"./SelectMenu-36JS-GAY.js";import{_ as _e}from"./Input-DKYkVkaK.js";import{_ as ue}from"./Icon-DLkENiec.js";import{_ as me}from"./Badge-BrOriF3i.js";import{_ as pe}from"./Empty-C2M2wGtg.js";import{_ as Oe}from"./Skeleton-C2dbKtp3.js";import{_ as $e}from"./Modal-CxM2Yew6.js";import"./usePortal-BjiTY23K.js";import"./Presence-CTfVoSjs.js";import"./VisuallyHidden-BSn5Ae5a.js";import"./PopperArrow-q2Y0TQCy.js";import"./utils-BSTWYaBh.js";import"./VisuallyHiddenInput-DDhaMnhq.js";import"./index-CygXWxiy.js";import"./useLocale-QzNUJIp8.js";import"./DialogTrigger-BCtGwlfO.js";function Ce(t){const w=Object.values(t).find(l=>l!==void 0);return Array.isArray(w)?w[0]??"Request gagal.":w??"Request gagal."}function Se(t){const w=ke(),l=he(),h=U([]),z=U(1),a=U(null),M=U(!1),x=U(!1),n=U(null),b=U(null),_=U(!1),g=U(null);oe(t.orders,s=>{const i=s.current_page??1,m=s.data??[];if(i<=1)h.value=[...m];else if(i>z.value){const O=new Set(h.value.map(D=>String(D.code))),j=m.filter(D=>!O.has(String(D.code)));h.value=[...h.value,...j]}z.value=i,a.value=s.next_page??null,M.value=!!s.has_more},{immediate:!0});const f=U(""),k=U("all"),I=U("newest"),c={pending:{label:"Menunggu",color:"warning",icon:"i-lucide-clock"},paid:{label:"Dibayar",color:"primary",icon:"i-lucide-badge-check"},processing:{label:"Diproses",color:"info",icon:"i-lucide-cog"},shipped:{label:"Dikirim",color:"info",icon:"i-lucide-truck"},delivered:{label:"Selesai",color:"success",icon:"i-lucide-check-circle-2"},cancelled:{label:"Dibatalkan",color:"neutral",icon:"i-lucide-x-circle"},refunded:{label:"Refund",color:"neutral",icon:"i-lucide-undo-2"}},S={unpaid:{label:"Belum bayar",color:"warning",icon:"i-lucide-alert-circle"},paid:{label:"Lunas",color:"success",icon:"i-lucide-credit-card"},refunded:{label:"Refund",color:"neutral",icon:"i-lucide-undo-2"},failed:{label:"Gagal",color:"error",icon:"i-lucide-ban"}},X=T(()=>[{label:"Semua status",value:"all"},...Object.entries(c).map(([s,i])=>({label:i.label,value:s}))]),Y=[{label:"Terbaru",value:"newest"},{label:"Terlama",value:"oldest"},{label:"Total tertinggi",value:"highest"},{label:"Total terendah",value:"lowest"}],Z=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(s),q=s=>{if(!s)return"-";const i=new Date(s);return Number.isNaN(i.getTime())?s:new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(i)},B=T(()=>{const s=f.value.trim().toLowerCase();let i=[...h.value];return k.value!=="all"&&(i=i.filter(m=>m.status===k.value)),s&&(i=i.filter(m=>[m.code,String(m.id),m.customer?.name??"",m.customer?.email??"",m.tracking_number??""].join(" ").toLowerCase().includes(s))),i.sort((m,O)=>{const j=new Date(m.created_at).getTime(),D=new Date(O.created_at).getTime();return I.value==="newest"?D-j:I.value==="oldest"?j-D:I.value==="highest"?O.total-m.total:m.total-O.total}),i}),R=T(()=>t.orders.value.total??h.value.length),ee=T(()=>B.value.length),te=T(()=>g.value?(g.value.items?.length??0)>0?g.value.items??[]:g.value.items_preview??[]:[]);function se(){f.value="",k.value="all",I.value="newest"}function E(){x.value||!M.value||!a.value||(x.value=!0,H.get("/dashboard",{section:"orders",orders_page:a.value},{only:["orders"],preserveState:!0,preserveScroll:!0,replace:!0,onFinish:()=>{x.value=!1}}))}function A(s){g.value={...s},_.value=!0}function F(){_.value=!1}oe(_,s=>{s||(g.value=null)});function L(s){return["unpaid","failed"].includes(String(s.payment_status??""))||s.payment_status==null&&s.status==="pending"}function V(s){const i=String(s.payment_method_code??"").trim().toLowerCase();return["p-001","midtrans"].includes(i)}function G(s){return L(s)&&V(s)}function ae(){return`${t.midtrans.value.env==="production"?"https://app.midtrans.com":"https://app.sandbox.midtrans.com"}/snap/snap.js`}async function ne(){return window.snap?.pay?!0:t.midtrans.value.client_key?new Promise(s=>{const i=document.querySelector('script[data-midtrans-snap="1"]');if(i){i.addEventListener("load",()=>s(!!window.snap?.pay)),i.addEventListener("error",()=>s(!1));return}const m=document.createElement("script");m.src=ae(),m.async=!0,m.setAttribute("data-midtrans-snap","1"),m.setAttribute("data-client-key",t.midtrans.value.client_key),m.onload=()=>s(!!window.snap?.pay),m.onerror=()=>s(!1),document.head.appendChild(m)}):!1}async function K(s,i={},m=["flash","errors"]){const O=String(l.props.csrf_token??"");return new Promise((j,D)=>{H.post(s,{_token:O,...i},{only:m,preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:re=>{const ge=re?.props??{};j(ge)},onError:re=>{D(new Error(Ce(re)))},onCancel:()=>{D(new Error("Request dibatalkan."))}})})}function P(s){return s?s.startsWith("http://")||s.startsWith("https://")||s.startsWith("/")?s:s.startsWith("storage/")?`/${s}`:`/storage/${s}`:null}function W(s){const i=s.shipping_address;return i?[i.address_line1,i.address_line2,i.district,i.city,i.province,i.postal_code,i.country].filter(m=>typeof m=="string"&&m.trim()!=="").join(", "):"-"}function ie(s){h.value=h.value.map(i=>String(i.id)===String(s.id)?{...i,...s}:i),g.value&&String(g.value.id)===String(s.id)&&(g.value={...g.value,...s})}async function le(s){if(n.value===null){n.value=String(s.id);try{const m=(await K(`/dashboard/orders/${s.id}/payment-status`,{},["flash","errors","orders"])).flash?.orders,O=m?.payload??{};O.order&&ie(O.order),w?.add?.({title:"Status pembayaran diperbarui",description:m?.message??"Status terbaru berhasil dimuat.",color:"success",icon:"i-lucide-badge-check"})}catch(i){const m=i instanceof Error?i.message:"Gagal memeriksa status pembayaran.";w?.add?.({title:"Cek status gagal",description:m,color:"error",icon:"i-lucide-x-circle"})}finally{n.value=null}}}async function fe(s){if(b.value===null&&G(s)){if(!t.midtrans.value.client_key){w?.add?.({title:"Midtrans belum aktif",description:"Client key Midtrans belum tersedia.",color:"error",icon:"i-lucide-x-circle"});return}b.value=String(s.id);try{_.value&&g.value&&String(g.value.id)===String(s.id)&&(_.value=!1,await ye());const m=(await K(`/dashboard/orders/${s.id}/pay-now`)).flash?.orders,O=m?.payload??{};if(O.redirectUrl){window.location.assign(O.redirectUrl);return}if(!O.snapToken)throw new Error(m?.message??"Token Midtrans tidak tersedia untuk order ini.");if(!await ne())throw new Error("Midtrans Snap gagal dimuat. Periksa konfigurasi client key.");b.value=null,window.snap?.pay(O.snapToken,{onSuccess:()=>{H.visit(O.successUrl??"/dashboard")},onPending:()=>{H.visit(O.pendingUrl??O.successUrl??"/dashboard")},onError:()=>{w?.add?.({title:"Pembayaran gagal",description:"Terjadi kesalahan saat memproses pembayaran Midtrans.",color:"error",icon:"i-lucide-x-circle"})},onClose:()=>{w?.add?.({title:"Pembayaran dibatalkan",description:"Kamu menutup popup pembayaran.",color:"warning",icon:"i-lucide-alert-circle"})}})}catch(i){const m=i instanceof Error?i.message:"Gagal membuka pembayaran Midtrans.";w?.add?.({title:"Bayar sekarang gagal",description:m,color:"error",icon:"i-lucide-x-circle"})}finally{b.value===String(s.id)&&(b.value=null)}}}return{allOrders:h,hasMore:M,nextPage:a,isLoadingMore:x,checkingPaymentOrderId:n,payingOrderId:b,isDetailOpen:_,selectedOrder:g,q:f,status:k,sort:I,statusMeta:c,paymentMeta:S,statusItems:X,sortItems:Y,filtered:B,totalCount:R,shownCount:ee,detailItems:te,formatCurrency:Z,formatDateTime:q,reset:se,loadMore:E,openDetail:A,closeDetail:F,isOrderUnpaid:L,canPayNow:G,checkPaymentStatus:le,payNow:fe,normalizeImageUrl:P,shippingAddressLine:W}}const Me={class:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"},Ue={class:"flex items-start gap-3"},ze={class:"flex size-10 items-center justify-center rounded-2xl border border-default bg-elevated/60"},Ie={class:"min-w-0"},De={class:"mt-0.5 text-xs text-muted"},Pe={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end"},je=Q({__name:"OrdersFiltersBar",props:{shownCount:{},totalCount:{},q:{},status:{},sort:{},statusItems:{},sortItems:{}},emits:["update:q","update:status","update:sort","reset"],setup(t,{emit:w}){const l=t,h=w;function z(x){h("update:q",String(x??""))}function a(x){h("update:status",x)}function M(x){h("update:sort",x)}return(x,n)=>{const b=ue,_=_e,g=we,f=ce;return d(),v("div",Me,[e("div",Ue,[e("div",ze,[o(b,{name:"i-lucide-package-search",class:"size-5 text-primary"})]),e("div",Ie,[n[1]||(n[1]=e("p",{class:"text-base font-semibold text-highlighted"},"Order",-1)),e("p",De,u(t.shownCount)+" dari "+u(t.totalCount)+" pesanan ",1)])]),e("div",Pe,[o(_,{"model-value":l.q,icon:"i-lucide-search",placeholder:"Cari kode, nama, resi...",size:"sm",class:"w-full sm:w-64","onUpdate:modelValue":z},null,8,["model-value"]),o(g,{"model-value":l.status,items:l.statusItems,"value-key":"value","label-key":"label",size:"sm",class:"w-full sm:w-44","onUpdate:modelValue":a},null,8,["model-value","items"]),o(g,{"model-value":l.sort,items:l.sortItems,"value-key":"value","label-key":"label",size:"sm",class:"w-full sm:w-44","onUpdate:modelValue":M},null,8,["model-value","items"]),l.q||l.status!=="all"||l.sort!=="newest"?(d(),C(f,{key:0,size:"sm",color:"neutral",variant:"ghost",icon:"i-lucide-rotate-ccw",onClick:n[0]||(n[0]=k=>h("reset"))},{default:p(()=>[...n[2]||(n[2]=[y(" Reset ",-1)])]),_:1})):$("",!0)])])}}}),Te={key:0,class:"p-4 sm:p-6"},Be={class:"grid gap-3"},Le={class:"flex items-start justify-between gap-3"},Ne={class:"w-full space-y-2"},qe={class:"mt-4 grid gap-2 sm:grid-cols-3"},Re={key:2},Ee={class:"grid gap-3"},Ae={class:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"},Fe={class:"min-w-0"},Ve={class:"flex flex-wrap items-center gap-2"},Ge={class:"text-sm font-extrabold text-highlighted"},Ke={class:"mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-muted"},We={class:"inline-flex items-center gap-1.5"},He={class:"inline-flex items-center gap-1.5"},Je={key:0,class:"inline-flex items-center gap-1.5"},Qe={key:1,class:"inline-flex items-center gap-1.5"},Xe={class:"flex items-center justify-between sm:flex-col sm:items-end gap-2"},Ye={class:"text-base font-black text-primary tabular-nums"},Ze={class:"flex flex-wrap items-center justify-end gap-2"},et={key:0,class:"mt-4"},tt={class:"mt-2 grid gap-2 sm:grid-cols-3"},st={class:"flex items-center gap-3"},at={class:"size-10 shrink-0 overflow-hidden rounded-xl bg-elevated/40"},nt=["src","alt"],it={key:1,class:"flex h-full w-full items-center justify-center"},lt={class:"min-w-0 flex-1"},rt={class:"truncate text-sm font-semibold text-highlighted"},ot={class:"mt-0.5 truncate text-xs text-muted"},dt={key:0},ct={class:"font-semibold tabular-nums text-highlighted/80"},ut={class:"mt-4 flex items-center justify-between text-xs text-muted"},mt={class:"inline-flex items-center gap-1.5"},pt={class:"hidden sm:inline-flex items-center gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity"},ft={key:0,class:"inline-flex items-center gap-2.5 text-sm text-muted"},gt={key:1,class:"space-y-2"},yt=Q({__name:"OrdersListGrid",props:{loading:{type:Boolean,default:!1},allOrders:{},filtered:{},statusMeta:{},paymentMeta:{},isLoadingMore:{type:Boolean},hasMore:{type:Boolean},payingOrderId:{},checkingPaymentOrderId:{},formatDateTime:{},formatCurrency:{},normalizeImageUrl:{},isOrderUnpaid:{},canPayNow:{}},emits:["open-detail","pay-now","check-payment-status","load-more","reset"],setup(t,{emit:w}){const l=t,h=w,z=U(null);let a=null;function M(){a&&(a.disconnect(),z.value&&a.observe(z.value))}return xe(()=>{a=new IntersectionObserver(x=>{x[0]?.isIntersecting&&h("load-more")},{rootMargin:"420px"}),M()}),oe(z,()=>M()),ve(()=>{a?.disconnect(),a=null}),(x,n)=>{const b=Oe,_=de,g=ce,f=pe,k=ue,I=me;return l.loading&&l.allOrders.length===0?(d(),v("div",Te,[e("div",Be,[(d(),v(N,null,J(4,c=>o(_,{key:c,class:"rounded-2xl",ui:{body:"p-4"}},{default:p(()=>[e("div",Le,[e("div",Ne,[o(b,{class:"h-4 w-52"}),o(b,{class:"h-3 w-72"}),o(b,{class:"h-3 w-56"})]),o(b,{class:"h-7 w-24 rounded-xl"})]),e("div",qe,[o(b,{class:"h-12 w-full rounded-2xl"}),o(b,{class:"h-12 w-full rounded-2xl"}),o(b,{class:"h-12 w-full rounded-2xl"})])]),_:1})),64))])])):l.filtered.length===0?(d(),C(f,{key:1,icon:"i-lucide-package-search",title:"Tidak ada pesanan ditemukan",description:"Coba ubah kata kunci atau filter.",variant:"outline",size:"lg",ui:{root:"rounded-2xl py-14"}},{actions:p(()=>[o(g,{size:"sm",color:"neutral",variant:"outline",icon:"i-lucide-rotate-ccw",onClick:n[0]||(n[0]=c=>h("reset"))},{default:p(()=>[...n[2]||(n[2]=[y(" Reset filter ",-1)])]),_:1})]),_:1})):(d(),v("div",Re,[e("div",Ee,[(d(!0),v(N,null,J(l.filtered,c=>(d(),C(_,{key:c.code,class:"rounded-xl overflow-hidden",ui:{root:"group relative hover:bg-elevated/30 transition-colors",body:"p-3 sm:p-3"}},{default:p(()=>[e("div",Ae,[e("div",Fe,[e("div",Ve,[e("p",Ge,"#"+u(c.code),1),o(I,{color:l.statusMeta[c.status]?.color,variant:"soft",size:"sm",class:"rounded-2xl"},{default:p(()=>[o(k,{name:l.statusMeta[c.status]?.icon,class:"mr-1 size-3.5"},null,8,["name"]),y(" "+u(l.statusMeta[c.status]?.label),1)]),_:2},1032,["color"]),c.payment_status?(d(),C(I,{key:0,color:l.paymentMeta[c.payment_status]?.color,variant:"subtle",size:"sm",class:"rounded-2xl"},{default:p(()=>[o(k,{name:l.paymentMeta[c.payment_status]?.icon,class:"mr-1 size-3.5"},null,8,["name"]),y(" "+u(l.paymentMeta[c.payment_status]?.label),1)]),_:2},1032,["color"])):$("",!0),c.tracking_number?(d(),C(I,{key:1,color:"neutral",variant:"subtle",size:"sm",class:"rounded-2xl"},{default:p(()=>[o(k,{name:"i-lucide-scan-line",class:"mr-1 size-3.5"}),y(" "+u(c.tracking_number),1)]),_:2},1024)):$("",!0)]),e("div",Ke,[e("span",We,[o(k,{name:"i-lucide-calendar",class:"size-3.5"}),y(" "+u(l.formatDateTime(c.created_at)),1)]),e("span",He,[o(k,{name:"i-lucide-shopping-bag",class:"size-3.5"}),y(" "+u(c.items_count)+" item ",1)]),c.payment_method?(d(),v("span",Je,[o(k,{name:"i-lucide-credit-card",class:"size-3.5"}),y(" "+u(c.payment_method),1)])):$("",!0),c.shipping_method?(d(),v("span",Qe,[o(k,{name:"i-lucide-truck",class:"size-3.5"}),y(" "+u(c.shipping_method),1)])):$("",!0)])]),e("div",Xe,[e("p",Ye,u(l.formatCurrency(c.total)),1),e("div",Ze,[o(g,{size:"xs",color:"primary",variant:"soft",class:"rounded-2xl",icon:"i-lucide-eye",onClick:S=>h("open-detail",c)},{default:p(()=>[...n[3]||(n[3]=[y(" Detail ",-1)])]),_:1},8,["onClick"]),l.canPayNow(c)?(d(),C(g,{key:0,size:"xs",color:"success",variant:"solid",class:"rounded-2xl",icon:"i-lucide-wallet",loading:l.payingOrderId===String(c.id),onClick:S=>h("pay-now",c)},{default:p(()=>[...n[4]||(n[4]=[y(" Bayar Sekarang ",-1)])]),_:1},8,["loading","onClick"])):$("",!0),l.isOrderUnpaid(c)?(d(),C(g,{key:1,size:"xs",color:"warning",variant:"outline",class:"rounded-2xl",icon:"i-lucide-refresh-cw",loading:l.checkingPaymentOrderId===String(c.id),onClick:S=>h("check-payment-status",c)},{default:p(()=>[...n[5]||(n[5]=[y(" Cek Status Bayar ",-1)])]),_:1},8,["loading","onClick"])):$("",!0),c.tracking_number?(d(),C(g,{key:2,size:"xs",color:"neutral",variant:"outline",class:"rounded-2xl",icon:"i-lucide-truck",onClick:S=>h("open-detail",c)},{default:p(()=>[...n[6]||(n[6]=[y(" Lacak ",-1)])]),_:1},8,["onClick"])):$("",!0)])])]),c.items_preview?.length?(d(),v("div",et,[n[8]||(n[8]=e("div",{class:"flex items-center justify-between"},[e("p",{class:"text-xs font-bold uppercase tracking-wider text-muted"},"Ringkasan item"),e("p",{class:"text-xs text-muted"},"Maks 3 ditampilkan")],-1)),e("div",tt,[(d(!0),v(N,null,J(c.items_preview.slice(0,3),S=>(d(),C(_,{key:S.id,class:"rounded-2xl",ui:{body:"p-3"}},{default:p(()=>[e("div",st,[e("div",at,[l.normalizeImageUrl(S.image)?(d(),v("img",{key:0,src:l.normalizeImageUrl(S.image)??void 0,alt:S.name,class:"h-full w-full object-cover",loading:"lazy"},null,8,nt)):(d(),v("div",it,[o(k,{name:"i-lucide-image",class:"size-5 text-muted"})]))]),e("div",lt,[e("p",rt,u(S.name),1),e("p",ot,[S.variant?(d(),v("span",dt,u(S.variant)+" 路 ",1)):$("",!0),y("x"+u(S.qty)+" ",1),n[7]||(n[7]=e("span",{class:"mx-1"},"路",-1)),e("span",ct,u(l.formatCurrency(S.price)),1)])])])]),_:2},1024))),128))])])):$("",!0),e("div",ut,[e("span",mt,[o(k,{name:"i-lucide-user",class:"size-3.5"}),y(" "+u(c.customer?.name??"Guest"),1)]),e("span",pt,[o(k,{name:"i-lucide-mouse-pointer-click",class:"size-3.5"}),n[9]||(n[9]=y(" Klik detail untuk info lengkap ",-1))])])]),_:2},1024))),128))]),e("div",{ref_key:"sentinel",ref:z,class:"pt-8 text-center"},[l.isLoadingMore?(d(),v("div",ft,[o(k,{name:"i-lucide-loader-2",class:"size-4 animate-spin text-primary"}),n[10]||(n[10]=y(" Memuat pesanan... ",-1))])):l.hasMore?(d(),v("div",gt,[n[12]||(n[12]=e("p",{class:"text-xs text-muted"},"Scroll untuk memuat lebih banyak pesanan.",-1)),o(g,{size:"xs",color:"neutral",variant:"outline",onClick:n[1]||(n[1]=c=>h("load-more"))},{default:p(()=>[...n[11]||(n[11]=[y(" Muat lebih banyak ",-1)])]),_:1})])):(d(),C(I,{key:2,color:"neutral",variant:"subtle",class:"rounded-2xl"},{default:p(()=>[o(k,{name:"i-lucide-check-circle-2",class:"mr-1 size-3.5 text-emerald-500"}),n[13]||(n[13]=y(" Semua pesanan sudah dimuat ",-1))]),_:1}))],512)]))}}}),ht={key:0,class:"space-y-4"},xt={class:"flex flex-wrap items-center gap-2"},vt={class:"grid gap-3 sm:grid-cols-2"},bt={class:"mt-2 space-y-1.5 text-sm"},kt={class:"flex items-center justify-between gap-3"},wt={class:"font-medium text-highlighted"},_t={class:"flex items-center justify-between gap-3"},Ot={class:"font-medium text-highlighted"},$t={class:"flex items-center justify-between gap-3"},Ct={class:"font-medium text-highlighted"},St={class:"flex items-center justify-between gap-3"},Mt={class:"font-medium text-highlighted"},Ut={class:"mt-2 space-y-1.5 text-sm"},zt={class:"flex items-center justify-between gap-3"},It={class:"font-medium text-highlighted"},Dt={class:"flex items-center justify-between gap-3"},Pt={class:"font-medium text-highlighted"},jt={class:"flex items-center justify-between gap-3"},Tt={class:"font-medium text-highlighted"},Bt={class:"flex items-center justify-between gap-3"},Lt={class:"font-medium text-highlighted"},Nt={class:"border-t border-default pt-2"},qt={class:"flex items-center justify-between gap-3"},Rt={class:"font-black text-primary tabular-nums"},Et={class:"mt-2 text-sm font-semibold text-highlighted"},At={class:"font-normal text-muted"},Ft={class:"mt-1 text-sm text-muted"},Vt={class:"flex items-center justify-between gap-3"},Gt={key:0,class:"mt-3 space-y-2"},Kt={class:"size-14 shrink-0 overflow-hidden rounded-lg bg-elevated/60"},Wt=["src","alt"],Ht={key:1,class:"flex h-full w-full items-center justify-center"},Jt={class:"min-w-0 flex-1"},Qt={class:"truncate text-sm font-semibold text-highlighted"},Xt={key:0,class:"truncate text-xs text-muted"},Yt={class:"truncate text-xs text-muted"},Zt={key:0},es={class:"shrink-0 text-sm font-bold tabular-nums text-highlighted"},ts={class:"mt-2 text-sm text-highlighted"},ss={class:"flex w-full flex-col-reverse gap-2 sm:flex-row sm:items-center sm:justify-between"},as={class:"flex flex-wrap items-center gap-2"},ns=Q({__name:"OrdersDetailModal",props:{open:{type:Boolean},selectedOrder:{default:null},detailItems:{},statusMeta:{},paymentMeta:{},checkingPaymentOrderId:{},payingOrderId:{},formatDateTime:{},formatCurrency:{},shippingAddressLine:{},normalizeImageUrl:{},isOrderUnpaid:{},canPayNow:{}},emits:["update:open","close","check-payment-status","pay-now"],setup(t,{emit:w}){const l=w;function h(){l("close"),l("update:open",!1)}return(z,a)=>{const M=ue,x=me,n=de,b=pe,_=ce,g=$e;return d(),C(g,{open:t.open,title:t.selectedOrder?`Detail Order #${t.selectedOrder.code}`:"Detail Order",description:"Ringkasan pembayaran, pengiriman, dan item order.",scrollable:"",content:{class:"w-[calc(100vw-1rem)] sm:max-w-4xl lg:max-w-5xl"},ui:{body:"max-h-[72vh] overflow-y-auto px-4 sm:px-6",footer:"px-4 sm:px-6 pb-4"},"onUpdate:open":a[2]||(a[2]=f=>l("update:open",f))},{body:p(()=>[t.selectedOrder?(d(),v("div",ht,[e("div",xt,[o(x,{color:t.statusMeta[t.selectedOrder.status]?.color,variant:"soft",class:"rounded-2xl"},{default:p(()=>[o(M,{name:t.statusMeta[t.selectedOrder.status]?.icon,class:"mr-1 size-3.5"},null,8,["name"]),y(" "+u(t.statusMeta[t.selectedOrder.status]?.label),1)]),_:1},8,["color"]),t.selectedOrder.payment_status?(d(),C(x,{key:0,color:t.paymentMeta[t.selectedOrder.payment_status]?.color,variant:"subtle",class:"rounded-2xl"},{default:p(()=>[o(M,{name:t.paymentMeta[t.selectedOrder.payment_status]?.icon,class:"mr-1 size-3.5"},null,8,["name"]),y(" "+u(t.paymentMeta[t.selectedOrder.payment_status]?.label),1)]),_:1},8,["color"])):$("",!0),t.selectedOrder.tracking_number?(d(),C(x,{key:1,color:"neutral",variant:"subtle",class:"rounded-2xl"},{default:p(()=>[o(M,{name:"i-lucide-scan-line",class:"mr-1 size-3.5"}),y(" "+u(t.selectedOrder.tracking_number),1)]),_:1})):$("",!0)]),e("div",vt,[o(n,{class:"rounded-2xl",ui:{root:"border border-default bg-elevated/20",body:"p-3"}},{default:p(()=>[a[7]||(a[7]=e("p",{class:"text-xs uppercase tracking-wider text-muted"},"Informasi Order",-1)),e("div",bt,[e("p",kt,[a[3]||(a[3]=e("span",{class:"text-muted"},"Tanggal Order",-1)),e("span",wt,u(t.formatDateTime(t.selectedOrder.created_at)),1)]),e("p",_t,[a[4]||(a[4]=e("span",{class:"text-muted"},"Dibayar Pada",-1)),e("span",Ot,u(t.formatDateTime(t.selectedOrder.paid_at)),1)]),e("p",$t,[a[5]||(a[5]=e("span",{class:"text-muted"},"Metode Bayar",-1)),e("span",Ct,u(t.selectedOrder.payment_method??"-"),1)]),e("p",St,[a[6]||(a[6]=e("span",{class:"text-muted"},"Kurir",-1)),e("span",Mt,u(t.selectedOrder.shipping_method??"-"),1)])])]),_:1}),o(n,{class:"rounded-2xl",ui:{root:"border border-default bg-elevated/20",body:"p-3"}},{default:p(()=>[a[13]||(a[13]=e("p",{class:"text-xs uppercase tracking-wider text-muted"},"Ringkasan Biaya",-1)),e("div",Ut,[e("p",zt,[a[8]||(a[8]=e("span",{class:"text-muted"},"Subtotal",-1)),e("span",It,u(t.formatCurrency(t.selectedOrder.subtotal??t.selectedOrder.total)),1)]),e("p",Dt,[a[9]||(a[9]=e("span",{class:"text-muted"},"Ongkir",-1)),e("span",Pt,u(t.formatCurrency(t.selectedOrder.shipping_cost??0)),1)]),e("p",jt,[a[10]||(a[10]=e("span",{class:"text-muted"},"Pajak",-1)),e("span",Tt,u(t.formatCurrency(t.selectedOrder.tax_amount??0)),1)]),e("p",Bt,[a[11]||(a[11]=e("span",{class:"text-muted"},"Diskon",-1)),e("span",Lt,"-"+u(t.formatCurrency(t.selectedOrder.discount_amount??0)),1)]),e("div",Nt,[e("p",qt,[a[12]||(a[12]=e("span",{class:"font-semibold text-highlighted"},"Total",-1)),e("span",Rt,u(t.formatCurrency(t.selectedOrder.total)),1)])])])]),_:1})]),t.selectedOrder.shipping_address?(d(),C(n,{key:0,class:"rounded-2xl",ui:{root:"border border-default bg-elevated/20",body:"p-3"}},{default:p(()=>[a[14]||(a[14]=e("p",{class:"text-xs uppercase tracking-wider text-muted"},"Alamat Pengiriman",-1)),e("p",Et,[y(u(t.selectedOrder.shipping_address.recipient_name??"-")+" ",1),e("span",At,"路 "+u(t.selectedOrder.shipping_address.recipient_phone??"-"),1)]),e("p",Ft,u(t.shippingAddressLine(t.selectedOrder)),1)]),_:1})):$("",!0),o(n,{class:"rounded-2xl",ui:{root:"border border-default bg-elevated/20",body:"p-3"}},{default:p(()=>[e("div",Vt,[a[15]||(a[15]=e("p",{class:"text-xs uppercase tracking-wider text-muted"},"Item Order",-1)),o(x,{color:"neutral",variant:"subtle",class:"rounded-xl"},{default:p(()=>[y(u(t.detailItems.length)+" item ",1)]),_:1})]),t.detailItems.length?(d(),v("div",Gt,[(d(!0),v(N,null,J(t.detailItems,f=>(d(),v("div",{key:f.id,class:"flex items-center gap-3 rounded-xl border border-default bg-default/10 p-2.5"},[e("div",Kt,[t.normalizeImageUrl(f.image)?(d(),v("img",{key:0,src:t.normalizeImageUrl(f.image)??void 0,alt:f.name,class:"h-full w-full object-cover",loading:"lazy"},null,8,Wt)):(d(),v("div",Ht,[o(M,{name:"i-lucide-image",class:"size-5 text-muted"})]))]),e("div",Jt,[e("p",Qt,u(f.name),1),f.sku?(d(),v("p",Xt,"SKU: "+u(f.sku),1)):$("",!0),e("p",Yt,[f.variant?(d(),v("span",Zt,u(f.variant)+" 路 ",1)):$("",!0),y(" "+u(f.qty)+" x "+u(t.formatCurrency(f.price)),1)])]),e("p",es,u(t.formatCurrency(f.row_total??f.price*f.qty)),1)]))),128))])):(d(),C(b,{key:1,icon:"i-lucide-shopping-bag",title:"Item order belum tersedia",description:"Data item tidak ditemukan pada order ini.",size:"sm",variant:"outline",ui:{root:"mt-3 rounded-xl py-8"}}))]),_:1}),t.selectedOrder.notes?(d(),C(n,{key:1,class:"rounded-2xl",ui:{root:"border border-default bg-elevated/20",body:"p-3"}},{default:p(()=>[a[16]||(a[16]=e("p",{class:"text-xs uppercase tracking-wider text-muted"},"Catatan Order",-1)),e("p",ts,u(t.selectedOrder.notes),1)]),_:1})):$("",!0)])):$("",!0)]),footer:p(()=>[e("div",ss,[e("div",as,[o(_,{color:"neutral",variant:"outline",class:"rounded-xl",onClick:h},{default:p(()=>[...a[17]||(a[17]=[y(" Tutup ",-1)])]),_:1}),t.selectedOrder&&t.isOrderUnpaid(t.selectedOrder)?(d(),C(_,{key:0,color:"warning",variant:"solid",class:"rounded-xl",icon:"i-lucide-refresh-cw",loading:t.checkingPaymentOrderId===String(t.selectedOrder.id),onClick:a[0]||(a[0]=f=>l("check-payment-status",t.selectedOrder))},{default:p(()=>[...a[18]||(a[18]=[y(" Cek status pembayaran ",-1)])]),_:1},8,["loading"])):$("",!0)]),t.selectedOrder&&t.canPayNow(t.selectedOrder)?(d(),C(_,{key:0,color:"success",variant:"solid",class:"rounded-xl",icon:"i-lucide-wallet",loading:t.payingOrderId===String(t.selectedOrder.id),onClick:a[1]||(a[1]=f=>l("pay-now",t.selectedOrder))},{default:p(()=>[...a[19]||(a[19]=[y(" Bayar sekarang ",-1)])]),_:1},8,["loading"])):$("",!0)])]),_:1},8,["open","title"])}}}),$s=Q({__name:"Orders",props:{orders:{default:()=>({data:[],current_page:1,next_page:null,has_more:!1,per_page:10,total:0})},midtrans:{default:()=>({env:"sandbox",client_key:""})},loading:{type:Boolean,default:!1}},setup(t){const w=t,{allOrders:l,hasMore:h,isLoadingMore:z,checkingPaymentOrderId:a,payingOrderId:M,isDetailOpen:x,selectedOrder:n,q:b,status:_,sort:g,statusMeta:f,paymentMeta:k,statusItems:I,sortItems:c,filtered:S,totalCount:X,shownCount:Y,detailItems:Z,formatCurrency:q,formatDateTime:B,reset:R,loadMore:ee,openDetail:te,closeDetail:se,isOrderUnpaid:E,canPayNow:A,checkPaymentStatus:F,payNow:L,normalizeImageUrl:V,shippingAddressLine:G}=Se({orders:T(()=>w.orders),midtrans:T(()=>w.midtrans)});function ae(P){b.value=P}function ne(P){_.value=P}function K(P){g.value=P}return(P,W)=>{const ie=de;return d(),v(N,null,[o(ie,{class:"rounded-3xl overflow-hidden"},{header:p(()=>[o(je,{"shown-count":r(Y),"total-count":r(X),q:r(b),status:r(_),sort:r(g),"status-items":r(I),"sort-items":r(c),"onUpdate:q":ae,"onUpdate:status":ne,"onUpdate:sort":K,onReset:r(R)},null,8,["shown-count","total-count","q","status","sort","status-items","sort-items","onReset"])]),default:p(()=>[o(yt,{loading:t.loading,"all-orders":r(l),filtered:r(S),"status-meta":r(f),"payment-meta":r(k),"is-loading-more":r(z),"has-more":r(h),"paying-order-id":r(M),"checking-payment-order-id":r(a),"format-date-time":r(B),"format-currency":r(q),"normalize-image-url":r(V),"is-order-unpaid":r(E),"can-pay-now":r(A),onOpenDetail:r(te),onPayNow:r(L),onCheckPaymentStatus:r(F),onLoadMore:r(ee),onReset:r(R)},null,8,["loading","all-orders","filtered","status-meta","payment-meta","is-loading-more","has-more","paying-order-id","checking-payment-order-id","format-date-time","format-currency","normalize-image-url","is-order-unpaid","can-pay-now","onOpenDetail","onPayNow","onCheckPaymentStatus","onLoadMore","onReset"])]),_:1}),o(ns,{open:r(x),"onUpdate:open":W[0]||(W[0]=le=>be(x)?x.value=le:null),"selected-order":r(n),"detail-items":r(Z),"status-meta":r(f),"payment-meta":r(k),"checking-payment-order-id":r(a),"paying-order-id":r(M),"format-date-time":r(B),"format-currency":r(q),"shipping-address-line":r(G),"normalize-image-url":r(V),"is-order-unpaid":r(E),"can-pay-now":r(A),onClose:r(se),onCheckPaymentStatus:r(F),onPayNow:r(L)},null,8,["open","selected-order","detail-items","status-meta","payment-meta","checking-payment-order-id","paying-order-id","format-date-time","format-currency","shipping-address-line","normalize-image-url","is-order-unpaid","can-pay-now","onClose","onCheckPaymentStatus","onPayNow"])],64)}}});export{$s as default};
